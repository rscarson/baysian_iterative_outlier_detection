\begin{tikzpicture}
  \begin{axis}[
        xlabel={$n$},
        ylabel={$p\_\text{fail}$},
        legend pos=south east,
        legend style={font=\scriptsize},
        grid=both,
        minor tick num=4,
        minor grid style={gray!10, thin},
        width=15cm,
        height=8cm,
        filter discard warning=false,
        scaled y ticks = false,
        yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},
        scaled x ticks = false,
        xticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2},
        xmode=log,
        log basis x=10,
        ymin=-0.75,
        ymax=1.5
  ]

    \pgfplotstableread[col sep=comma]{results/p_fail_experiment3_bigp.csv}\datatablebig
    \pgfplotstableread[col sep=comma]{results/p_fail_experiment3_goodp.csv}\datatablegood
    \pgfplotstableread[col sep=comma]{results/p_fail_experiment3_smallp.csv}\datatablesmall

    \addplot[thick, blue] table[x=n, y=p_fail_true, col sep=comma] {\datatablegood}; % we used the same simulated data for all three
    \addlegendentry{Simulated True $p\_\text{fail}$}

    \addplot[
        red, dashed, thick,
        error bars/.cd,
            y dir=both,
            y explicit
    ] table[
        x=n, y=p_fail_biod_min_mean,
        y error plus=p_fail_biod_min_stdev,
        y error minus=p_fail_biod_min_stdev,
    ]{\datatablebig};
    \addlegendentry{$p_\text{fail}$ 95\% CI (overestimated $p$)}
    
    \addplot[
        green, dashed, thick,
        error bars/.cd,
            y dir=both,
            y explicit
    ] table[
        x=n, y=p_fail_biod_min_mean,
        y error plus=p_fail_biod_min_stdev,
        y error minus=p_fail_biod_min_stdev,
    ]{\datatablesmall};
    \addlegendentry{$p_\text{fail}$ 95\% CI (underestimated $p$)}

    \addplot[
        blue, dashed, thick,
        error bars/.cd,
            y dir=both,
            y explicit
    ] table[
        x=n, y=p_fail_biod_min_mean,
        y error plus=p_fail_biod_min_stdev,
        y error minus=p_fail_biod_min_stdev,
    ]{\datatablegood};

    % Red series
    \addplot[
        only marks,
        mark=none,
        nodes near coords={$k=\pgfplotspointmeta$},
        every node near coord/.append style={
            font=\scriptsize\color{red!60!black},
            anchor=south,
            yshift=2pt
        },
        point meta=explicit symbolic
    ] table[x=n, y expr=1.25, meta=biod_iterations] {\datatablebig};

    % Blue series
    \addplot[
        only marks,
        mark=none,
        nodes near coords={$k=\pgfplotspointmeta$},
        every node near coord/.append style={
            font=\scriptsize\color{blue!60!black},
            anchor=south,
            yshift=-6pt
        },
        point meta=explicit symbolic
    ] table[x=n, y expr=1.25, meta=biod_iterations] {\datatablegood};

    % Green series
    \addplot[
        only marks,
        mark=none,
        nodes near coords={$k=\pgfplotspointmeta$},
        every node near coord/.append style={
            font=\scriptsize\color{green!60!black},
            anchor=south,
            yshift=-14pt
        },
        point meta=explicit symbolic
    ] table[x=n, y expr=1.25, meta=biod_iterations] {\datatablesmall};
  \end{axis}
\end{tikzpicture}